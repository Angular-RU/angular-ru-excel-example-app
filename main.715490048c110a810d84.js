(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("2v48")},"2v48":function(e,t,n){"use strict";n.r(t);var r=n("ENSU"),o=n("kZht");function a(e){var t="string"==typeof e?e.trim():e;return[void 0,null,NaN,"","null",1/0].includes(t)}function i(e){return null==e}var c,s=n("6uGs"),u=n("hCLc"),l=n("uryd"),f=n("P0vk"),d=n("aJOL"),v=n("FxgA"),b=n("1VvW"),p=n("bI4O"),h=n("jg4I"),y=n("ROBh"),m=n("gCgJ"),k=(n("K8MB"),n("pTnX")),g=n("An66");function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return new Date(e.setHours(23,59,59,999))}function O(e){var t,n,r,o,a,i,c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,u=new Date(s),l=u.getFullYear()+(null!==(t=e.years)&&void 0!==t?t:0),f=u.getMonth()+(null!==(n=e.months)&&void 0!==n?n:0),d=u.getDate()+(null!==(r=e.days)&&void 0!==r?r:0),v=u.getHours()+(null!==(o=e.hours)&&void 0!==o?o:0),b=u.getMinutes()+(null!==(a=e.minutes)&&void 0!==a?a:0),p=u.getSeconds()+(null!==(i=e.seconds)&&void 0!==i?i:0),h=u.getMilliseconds()+(null!==(c=e.milliseconds)&&void 0!==c?c:0);return new Date(l,f,d,v,b,p,h)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return new Date(e.setHours(0,0,0,0))}n("mPN/"),n("XlW9"),new o.r("Suggestion strategy map");var x=function(){var e=function(){function e(t){Object(p.a)(this,e),this.dateAdapter=t}return Object(h.a)(e,[{key:"updateIntervalFor",value:function(e,t){var n,r=t.dateFromKey,o=t.dateToKey,a=((new Date).getDay()+7-this.dateAdapter.getFirstDayOfWeek())%7;e.patchValue((n={},Object(m.a)(n,r,w(O({days:-a}))),Object(m.a)(n,o,j()),n))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(k.a))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),E=function(){var e=function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,[{key:"updateIntervalFor",value:function(e,t){var n,r=t.dateFromKey,o=t.dateToKey;e.patchValue((n={},Object(m.a)(n,r,w(e.value[r])),Object(m.a)(n,o,j(e.value[r])),n))}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),T=new o.r("Days count for date suggestion"),N=function(){var e=function(){function e(t){Object(p.a)(this,e),this.lastDaysCount=t}return Object(h.a)(e,[{key:"updateIntervalFor",value:function(e,t){var n,r=t.dateFromKey,o=t.dateToKey,a=-(this.lastDaysCount-1);e.patchValue((n={},Object(m.a)(n,r,w(O({days:a},e.value[o]))),Object(m.a)(n,o,j(e.value[o])),n))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(T))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),D=function(){var e=function(){function e(t){Object(p.a)(this,e),this.daysCount=t}return Object(h.a)(e,[{key:"updateIntervalFor",value:function(e,t){var n,r=t.dateFromKey,o=t.dateToKey,a=-(this.daysCount-1);e.patchValue((n={},Object(m.a)(n,r,w(O({days:a}))),Object(m.a)(n,o,j()),n))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(T))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),S=function(){var e=function(){function e(t){Object(p.a)(this,e),this.daysCount=t}return Object(h.a)(e,[{key:"updateIntervalFor",value:function(e,t){var n,r=t.dateFromKey,o=t.dateToKey,a=O({days:-this.daysCount});e.patchValue((n={},Object(m.a)(n,r,w(a)),Object(m.a)(n,o,j(a)),n))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(T))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}();function W(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null!=e?e:(new Date).getTime(),a=null!==(t=r.format)&&void 0!==t?t:"dd.MM.yyyy HH:mm:ss";return null!==(n=new g.d("en-US").transform(o,a,r.timezone))&&void 0!==n?n:""}c={},Object(m.a)(c,"TODAY",{strategy:S,providers:[{provide:T,useValue:0}]}),Object(m.a)(c,"YESTERDAY",{strategy:S,providers:[{provide:T,useValue:1}]}),Object(m.a)(c,"CALENDAR_WEEK",{strategy:x}),Object(m.a)(c,"LAST_3_DAYS",{strategy:D,providers:[{provide:T,useValue:3}]}),Object(m.a)(c,"LAST_7_DAYS",{strategy:D,providers:[{provide:T,useValue:7}]}),Object(m.a)(c,"LAST_99_DAYS",{strategy:D,providers:[{provide:T,useValue:99}]}),Object(m.a)(c,"FIRST_DAY_OF_INTERVAL",{strategy:E}),Object(m.a)(c,"LAST_99_DAYS_OF_INTERVAL",{strategy:N,providers:[{provide:T,useValue:99}]});var C=function(){var e=function(){function e(){Object(p.a)(this,e),this.workerFunctionToUrlMap=new WeakMap,this.promiseToWorkerMap=new WeakMap}return Object(h.a)(e,[{key:"run",value:function(e,t){var n=this.getOrCreateWorkerUrl(e);return this.runUrl(n,t)}},{key:"runUrl",value:function(e,t){var n=new Worker(e),r=this.createPromiseForWorker(n,t),o=this.createPromiseCleaner(r);return this.promiseToWorkerMap.set(r,n),r.then(o).catch(o),r}},{key:"terminate",value:function(e){return this.removePromise(e)}},{key:"getWorker",value:function(e){return this.promiseToWorkerMap.get(e)}},{key:"createPromiseForWorker",value:function(e,t){return new Promise(function(n,r){e.addEventListener("message",function(e){return n(e.data)}),e.addEventListener("error",r),e.postMessage(t)})}},{key:"getOrCreateWorkerUrl",value:function(t){if(!this.workerFunctionToUrlMap.has(t)){var n=e.createWorkerUrl(t);return this.workerFunctionToUrlMap.set(t,n),n}return this.workerFunctionToUrlMap.get(t)}},{key:"createPromiseCleaner",value:function(e){var t=this;return function(n){return t.removePromise(e),n}}},{key:"removePromise",value:function(e){var t=this.promiseToWorkerMap.get(e);return t&&t.terminate(),this.promiseToWorkerMap.delete(e),e}}],[{key:"createWorkerUrl",value:function(e){var t=e.toString(),n="\n            self.addEventListener('message', function(e) {\n                postMessage((".concat(t,")(e.data));\n            });\n        "),r=new Blob([n],{type:"text/javascript"});return URL.createObjectURL(r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),A=n("aDqW"),F=function(){var e=function(){function e(t){Object(p.a)(this,e),this.webWorker=t}return Object(h.a)(e,[{key:"exportExcelByWorkbook",value:function(e){this.webWorker.run(function(e){var t,n,r,o,a={HEAD:"HeadCellStyle",BODY:"BodyCellStyle",BIG_DATA:"CellBigDataStyle"},i=(t=e.worksheets,n=l(e.translatedKeys),r=a,o="",t.forEach(function(e){var t=e.worksheetName,a=e.entries||[],i=function(e,t,n){var r,o=l(t,e.excludeKeys);return("number"==typeof(null===(r=e.keys)||void 0===r?void 0:r.length)?e.keys:Object.keys(o)).map(function(t){var r,o=void 0!==n["".concat(null==e?void 0:e.prefixKeyForTranslate,".").concat(t)]?n["".concat(null==e?void 0:e.prefixKeyForTranslate,".").concat(t)]:t;return r=t,f(o)!==f(r)?o:t})}(e,a[0],n);o+='\n                          <Worksheet ss:Name="'.concat(t,'"><Table ss:DefaultColumnWidth="').concat(140,'" ss:DefaultRowHeight="').concat(40,'">').concat(function(e,t,n){return e.reduce(function(e,t){var n=7*t.length;return e+'<Column ss:Width="'.concat(n>140?n:140,'" />')},"")}(i),"\n                              ").concat(function(e,t,n,r,o,a,i){var s="";return t.forEach(function(t,r){var o=0===r?"\t<Row>".concat(function(e,t){return e.reduce(function(e,n){return e+c(n,t.HEAD)},"")}(n,i),"\t</Row>"):"";s+="".concat(o,'<Row ss:Height="').concat(40,'"> ').concat(function(e,t,n,r,o){return function(e,t,n,r,o){var a,i="";return("number"==typeof(null===(a=e.keys)||void 0===a?void 0:a.length)?e.keys:Object.keys(t)).forEach(function(e){var n=String(t[e]).length;i+=c(t[e],5*n>=140?o.BIG_DATA:o.BODY)}),i}(e,l(t,e.excludeKeys),0,0,o)}(e,t,0,0,i),"  </Row>\n                                         ")}),s}(e,a,i,0,0,0,r),"\n                            </Table> </Worksheet>\n                          ")}),o);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"String",r="number"==typeof e?"Number":n,o=s(e,"-");return"string"==typeof o&&(o=(o=o.trim()).replace(/[<>]/g,"")),'<Cell ss:StyleID="'.concat(t,'"><Data ss:Type="').concat(r,'">').concat(o,"</Data></Cell>")}function s(e,t){return function(e){var t="string"==typeof e?e.trim():e;return[void 0,null,NaN,"","null",1/0].includes(t)}(e)?t:e}function u(e,t,n){if("object"==typeof e[n]&&null!==e[n]){var r=l(e[n]);for(var o in r)r.hasOwnProperty(o)&&(t["".concat(n,".").concat(o)]=r[o])}else t[n]=e[n]}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={};for(var r in e)(null==e?void 0:e.hasOwnProperty(r))&&!t.includes(r)&&u(e,n,r);return n}function f(e){return e.split(".").pop()}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'<Font ss:Bold="0" ss:FontName="Arial" />';return"".concat(e,'\n                        <Borders>\n                            <Border ss:Position="Top" ss:Color="#000000" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Bottom" ss:Color="#000000" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Right" ss:Color="#000000" ss:LineStyle="Continuous" ss:Weight="1"/>\n                            <Border ss:Position="Left" ss:Color="#000000" ss:LineStyle="Continuous" ss:Weight="1"/>\n                        </Borders>')}var v='\n                          <?xml version="1.0"?>\n                          <?mso-application progid="Excel.Sheet"?>\n                          <Workbook\n                           xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n                           xmlns:o="urn:schemas-microsoft-com:office:office"\n                           xmlns:x="urn:schemas-microsoft-com:office:excel"\n                           xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n                           xmlns:html="https://www.w3.org/TR/html40/">\n                           <Styles>\n                            <Style ss:ID="'.concat(a.HEAD,'">\n                               <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="0" />\n                               ').concat(d('<Font ss:Bold="1" ss:FontName="Arial" />'),'\n                            </Style>\n                            <Style ss:ID="').concat(a.BIG_DATA,'">\n                               <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1" />\n                               ').concat(d(),'\n                            </Style>\n                            <Style ss:ID="').concat(a.BODY,'">\n                              <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="0" />\n                              ').concat(d(),"\n                            </Style>\n                          </Styles>\n                           ").concat(i,"\n                          </Workbook>\n                      ");return new Blob(["\ufeff",v],{type:"application/vnd.ms-excel;charset=UTF-8"})},e).then(function(t){return function(e){if(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(a)}(e.name,e.extension))throw new Error("File name or file extension must be provided");var t=document.createElement("a"),n=window.URL.createObjectURL(e.blob),r=[e.name,e.extension].filter(Boolean).join(".");t.href=n,t.download=r,t.click(),window.URL.revokeObjectURL(n)}({blob:t,name:"".concat(e.filename,".").concat(W()),extension:"xls"})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(C))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),L=new o.r("EXCEL_BUILDER_INTERCEPTOR_TOKEN"),_=function(){var e=function(){function e(t,n){Object(p.a)(this,e),this.interceptor=t,this.builder=n}return Object(h.a)(e,[{key:"exportExcel",value:function(e){var t=this;this.getTranslatedColumn().toPromise().then(function(n){var r;t.builder.exportExcelByWorkbook({filename:t.interceptFilename(e),worksheets:t.interceptWorksheets(e),translatedKeys:null!==(r=null!=n?n:e.translatedKeys)&&void 0!==r?r:{}})})}},{key:"interceptFilename",value:function(e){var t,n,r,o;return null!==(o=null!==(r=null===(n=(t=this.interceptor).instant)||void 0===n?void 0:n.call(t,e.filename))&&void 0!==r?r:e.filename)&&void 0!==o?o:"UNKNOWN FILENAME"}},{key:"interceptWorksheets",value:function(e){var t,n=this;return(null!==(t=e.worksheets)&&void 0!==t?t:[]).map(function(e){var t,r,o,a,i,c=null!==(a=null!==(o=null===(r=null===(t=n.interceptor)||void 0===t?void 0:t.instant)||void 0===r?void 0:r.call(t,e.worksheetName))&&void 0!==o?o:e.worksheetName)&&void 0!==a?a:"UNKNOWN WORKSHEET NAME",s=null===(i=e.keys)||void 0===i?void 0:i.filter(function(t){var n,r;return!(null!==(r=null===(n=e.excludeKeys)||void 0===n?void 0:n.includes(t))&&void 0!==r&&r)});return Object.assign(Object.assign({},e),{keys:s,worksheetName:c})})}},{key:"getTranslatedColumn",value:function(){var e,t,n;return null!==(n=null===(t=null===(e=this.interceptor)||void 0===e?void 0:e.getTranslatedColumn)||void 0===t?void 0:t.call(e))&&void 0!==n?n:Object(y.a)(null)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(L),o.Sb(F))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}(),K=function(){var e=function e(){Object(p.a)(this,e)};return e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac=function(t){return new(t||e)}}),e}(),M=function(){var e=function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,null,[{key:"forRoot",value:function(){return{ngModule:e,providers:[_,F,{provide:L,useClass:K}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Jb({type:e}),e.\u0275inj=o.Ib({providers:[C]}),e}(),R={provide:L,useClass:function(){var e=function(){function e(t){Object(p.a)(this,e),this.translate=t}return Object(h.a)(e,[{key:"instant",value:function(e){return i(e)?e:this.translate.instant(e)}},{key:"getTranslatedColumn",value:function(){var e,t=null!==(e=this.translate.currentLang)&&void 0!==e?e:this.translate.defaultLang;if(i(t))throw new Error("Not found lang");return this.translate.getTranslation(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Sb(A.c))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e}()},P=n("cgGC"),H=n("8EXQ"),B=function(){function e(e,t){this.excel=e,this.translate=t,this.data=[{id:"id",name:"Maria",info:{value:1,other:2},excluded:"excluded",description:"Fugiat tempor sunt nostrud ad fugiat. Laboris velit duis incididunt culpa"}],this.translate.setDefaultLang("ru")}return e.prototype.exportExcel=function(){this.excel.exportExcel({filename:"My excel file",worksheets:[{entries:this.data,worksheetName:"worksheet name",excludeKeys:["excluded"]}]})},e.prototype.exportExcelWithI18n=function(){this.excel.exportExcel({filename:"APP_KEYS.TITLE",worksheets:[{entries:this.data,prefixKeyForTranslate:"APP_KEYS.MODELS",worksheetName:"APP_KEYS.WORKSHEET_NAME",keys:["info.value","description","name"],excludeKeys:["description"]}]})},e.\u0275fac=function(t){return new(t||e)(o.Lb(_),o.Lb(A.c))},e.\u0275cmp=o.Fb({type:e,selectors:[["app-root"]],decls:51,vars:0,consts:[[1,"dashboard"],["mode","side","opened","",1,"dashboard__menu"],[1,"title"],["src","assets/img/angular.svg","alt","angular",1,"logo"],["routerLink","/",1,"logo-title"],[1,"menu"],[1,"menu__item"],["routerLink","/"],[1,"dashboard__content"],[1,"dashboard__content-examples"],["mat-button","","mat-stroked-button","",3,"click"]],template:function(e,t){1&e&&(o.Ob(0,"mat-drawer-container",0),o.jc(1,"\n    "),o.Ob(2,"mat-drawer",1),o.jc(3,"\n        "),o.Ob(4,"mat-toolbar",2),o.jc(5,"\n            "),o.Mb(6,"img",3),o.jc(7,"\n            "),o.Ob(8,"a",4),o.jc(9,"@angular-ru/ng-excel-builder"),o.Nb(),o.jc(10,"\n        "),o.Nb(),o.jc(11,"\n\n        "),o.Ob(12,"mat-list",5),o.jc(13,"\n            "),o.Ob(14,"mat-list-item",6),o.jc(15,"\n                "),o.Ob(16,"a",7),o.jc(17,"- "),o.Ob(18,"strong"),o.jc(19,"Guide overview"),o.Nb(),o.Nb(),o.jc(20,"\n            "),o.Nb(),o.jc(21,"\n            "),o.Mb(22,"mat-divider"),o.jc(23,"\n        "),o.Nb(),o.jc(24,"\n    "),o.Nb(),o.jc(25,"\n\n    "),o.Ob(26,"mat-drawer-content",8),o.jc(27,"\n        "),o.Ob(28,"div",9),o.jc(29,"\n            "),o.Ob(30,"div"),o.jc(31,"\n                "),o.Ob(32,"h3"),o.jc(33,"Export excel"),o.Nb(),o.jc(34,"\n                "),o.Ob(35,"button",10),o.Vb("click",function(){return t.exportExcel()}),o.jc(36,"Export excel"),o.Nb(),o.jc(37,"\n            "),o.Nb(),o.jc(38,"\n\n            "),o.Ob(39,"div"),o.jc(40,"\n                "),o.Ob(41,"h3"),o.jc(42,"Export with i18n (lang: ru)"),o.Nb(),o.jc(43,"\n                "),o.Ob(44,"button",10),o.Vb("click",function(){return t.exportExcelWithI18n()}),o.jc(45,"Export excel"),o.Nb(),o.jc(46,"\n            "),o.Nb(),o.jc(47,"\n        "),o.Nb(),o.jc(48,"\n    "),o.Nb(),o.jc(49,"\n"),o.Nb(),o.jc(50,"\n"))},directives:[f.b,f.a,d.a,b.a,l.a,l.b,H.a,f.c,u.a],styles:[""],encapsulation:2,changeDetection:0}),e}();function I(e){return new P.a(e,"./assets/i18n/",".json")}var U=function(){function e(){}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Jb({type:e,bootstrap:[B]}),e.\u0275inj=o.Ib({providers:[R],imports:[[r.a,l.c,s.b,d.b,f.d,u.b,v.b,A.b.forRoot({loader:{deps:[s.a],provide:A.a,useFactory:I}}),b.b.forRoot([]),M.forRoot()]]}),e}();Object(o.T)(),r.b().bootstrapModule(U).catch(function(e){return console.error(e)})},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0,5]]]);